# 🌐 LUMI 多语言系统实施指南

## ✅ 已完成的工作

### 1. 安装依赖
```bash
npm install react-i18next i18next i18next-browser-languagedetector
```

### 2. 创建的文件

#### 📁 locales/en.json
英文翻译文件，包含所有英文文本

#### 📁 locales/zh.json
中文翻译文件，包含所有中文文本

#### 📁 lib/i18n.ts
i18n配置文件，设置默认语言为英文

#### 📁 hooks/useTranslation.ts
自定义Hook，简化在组件中使用翻译

#### 📁 components/LanguageSwitcher.tsx
语言切换组件，已集成到导航栏

---

## 🚀 如何在页面中使用多语言

### 步骤1: 导入Hook

```typescript
'use client';
import { useTranslation } from '@/hooks/useTranslation';

export default function MyPage() {
  const { t, i18n } = useTranslation();
  
  // 使用 t() 函数翻译文本
  return (
    <div>
      <h1>{t('blackSwan.title')}</h1>
      <p>{t('blackSwan.subtitle')}</p>
    </div>
  );
}
```

### 步骤2: 替换硬编码文本

**之前：**
```tsx
<h1>Black Swan Detection System</h1>
<p>Market Anomaly Detection Platform</p>
```

**之后：**
```tsx
<h1>{t('blackSwan.title')}</h1>
<p>{t('blackSwan.subtitle')}</p>
```

### 步骤3: 添加新的翻译键

如果需要新的翻译，在 `locales/en.json` 和 `locales/zh.json` 中添加：

**locales/en.json:**
```json
{
  "myPage": {
    "title": "My Page Title",
    "description": "My page description"
  }
}
```

**locales/zh.json:**
```json
{
  "myPage": {
    "title": "我的页面标题",
    "description": "我的页面描述"
  }
}
```

---

## 📋 翻译键结构

当前的翻译键按照功能模块组织：

```
common.*          - 通用文本（按钮、标签等）
nav.*             - 导航相关
hero.*            - 首页英雄区
market.*          - 市场相关
blackSwan.*       - 黑天鹅页面
orderbook.*       - 订单簿
categories.*      - 分类
footer.*          - 页脚
```

---

## 💡 使用示例

### 示例 1: 简单文本替换
```tsx
// 原文本
<button>Buy</button>

// 使用翻译
<button>{t('market.buy')}</button>
```

### 示例 2: 带变量的翻译
首先在翻译文件中定义：
```json
{
  "market": {
    "volume": "Volume: {{value}}"
  }
}
```

然后使用：
```tsx
<p>{t('market.volume', { value: '1000' })}</p>
```

### 示例 3: 大写文本
```tsx
<h1>{t('blackSwan.title').toUpperCase()}</h1>
```

### 示例 4: 条件文本
```tsx
<span>
  {t(isActive ? 'common.active' : 'common.pending')}
</span>
```

### 示例 5: 获取当前语言
```tsx
const { i18n } = useTranslation();
const currentLang = i18n.language; // 'en' 或 'zh'

// 根据语言显示不同内容
const dateFormat = i18n.language === 'zh' ? 'YYYY年MM月DD日' : 'MMM DD, YYYY';
```

---

## 🎨 LanguageSwitcher 组件

语言切换器已添加到 `components/Navbar.tsx` 中，位于：
- 余额显示之后
- 钱包连接按钮之前

**特性：**
- ✅ 下拉菜单样式
- ✅ 显示当前选中语言
- ✅ 自动保存到 localStorage
- ✅ 美观的UI设计
- ✅ 点击外部自动关闭

---

## 🔧 配置详情

### 默认语言
当前设置为 **英文（en）**

如需修改，编辑 `lib/i18n.ts`:
```typescript
lng: 'en', // 改为 'zh' 可设置中文为默认
```

### 语言检测顺序
1. localStorage (`lumi-language`)
2. 浏览器语言

### 持久化存储
用户选择的语言会自动保存到 `localStorage`，键名为 `lumi-language`

---

## 📝 待完成的页面

以下页面需要添加多语言支持：

### 高优先级
- [ ] `app/page.tsx` - 首页
- [ ] `app/markets/page.tsx` - 市场列表页
- [x] `app/black-swan/page.tsx` - 黑天鹅页面（部分完成）
- [ ] `components/Navbar.tsx` - 导航栏（部分完成，还有类别名称）

### 中优先级
- [ ] `app/market/[id]/page.tsx` - 市场详情页
- [ ] `app/trending/page.tsx` - 热门页
- [ ] `app/breaking/page.tsx` - 突发页
- [ ] `app/lottery/page.tsx` - 彩票页

### 低优先级
- [ ] 各个分类页面
- [ ] 表单和模态框
- [ ] 错误提示

---

## 🎯 最佳实践

### ✅ 推荐做法

1. **始终使用翻译键，不要硬编码文本**
   ```tsx
   // ✅ 好
   <h1>{t('page.title')}</h1>
   
   // ❌ 不好
   <h1>Page Title</h1>
   ```

2. **保持翻译键的一致性**
   ```
   market.buy  ✅
   market.sell ✅
   marketBuyButton ❌（不一致）
   ```

3. **按功能模块组织翻译**
   ```json
   {
     "market": {
       "buy": "Buy",
       "sell": "Sell"
     }
   }
   ```

4. **为长文本使用描述性键名**
   ```json
   {
     "blackSwan": {
       "subtitle": "Market Anomaly Detection Platform",
       "description": "Real-time alert system..."
     }
   }
   ```

### ❌ 避免的做法

1. 不要混用硬编码和翻译
2. 不要在 JSX 中直接写中文
3. 不要使用模糊的键名（如 `text1`, `label2`）
4. 不要忘记同步更新英文和中文翻译文件

---

## 🔍 调试技巧

### 查看当前语言
```tsx
console.log('Current language:', i18n.language);
```

### 查看所有翻译键
```tsx
console.log('Translations:', i18n.store.data[i18n.language].translation);
```

### 启用调试模式
编辑 `lib/i18n.ts`:
```typescript
debug: true, // 在控制台显示翻译信息
```

---

## 📦 文件清单

### 新增文件
```
locales/
  ├── en.json                    # 英文翻译
  └── zh.json                    # 中文翻译

lib/
  └── i18n.ts                    # i18n配置

hooks/
  └── useTranslation.ts          # 翻译Hook

components/
  └── LanguageSwitcher.tsx       # 语言切换组件
```

### 修改文件
```
components/Navbar.tsx              # 添加了LanguageSwitcher
app/black-swan/page.tsx           # 添加了部分翻译（示例）
```

---

## 🚀 快速开始

### 1. 测试语言切换
启动开发服务器后，点击导航栏右上角的语言切换器，切换语言查看效果。

### 2. 添加新翻译
需要翻译新页面时：
1. 在 `locales/en.json` 和 `locales/zh.json` 中添加键值对
2. 在组件中导入 `useTranslation`
3. 使用 `t('key')` 替换硬编码文本

### 3. 验证翻译
- 切换语言查看文本是否正确
- 确保中英文都有对应翻译
- 检查控制台是否有缺失翻译的警告

---

## 📞 常见问题

### Q: 为什么看不到翻译？
A: 确保：
1. 翻译键在 JSON 文件中存在
2. 组件中导入了 `useTranslation`
3. 没有拼写错误

### Q: 如何添加第三种语言？
A: 
1. 创建 `locales/新语言代码.json`
2. 在 `lib/i18n.ts` 中导入并添加到 resources
3. 在 `LanguageSwitcher.tsx` 中添加选项

### Q: 翻译不更新怎么办？
A: 重启开发服务器，或清除浏览器缓存

### Q: 能否根据IP自动切换语言？
A: 可以，但需要额外的地理位置检测库和API

---

## 🎉 总结

多语言系统已经完全集成到LUMI项目中：

✅ i18n库已安装并配置
✅ 默认语言设置为英文
✅ 语言切换器已添加到导航栏
✅ 翻译文件结构完整
✅ 黑天鹅页面已部分翻译（示例）
✅ 语言选择会持久化保存

**下一步：** 根据本指南，为其他页面添加多语言支持。









