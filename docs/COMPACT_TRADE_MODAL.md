# ç´§å‡‘äº¤æ˜“å¼¹çª—è®¾è®¡ (Compact Trade Modal)

## ğŸ“‹ æ¦‚è¿°

å…¨æ–°è®¾è®¡çš„ç´§å‡‘äº¤æ˜“å¼¹çª—ï¼Œé‡‡ç”¨å°å¡ç‰‡æ ·å¼ï¼Œæä¾›æ›´ç®€æ´ã€æ›´ç›´è§‚çš„äº¤æ˜“ä½“éªŒã€‚

## ğŸ¨ è®¾è®¡ç‰¹ç‚¹

### 1. å°å¡ç‰‡æ ·å¼
- ç´§å‡‘çš„å°ºå¯¸ï¼ˆmax-w-smï¼Œæœ€å¤§å®½åº¦384pxï¼‰
- åŠé€æ˜èƒŒæ™¯æ•ˆæœï¼ˆbg-zinc-900/95 + backdrop-blurï¼‰
- ä¼˜é›…çš„è¾¹æ¡†å’Œé˜´å½±æ•ˆæœ
- æµç•…çš„åŠ¨ç”»è¿‡æ¸¡

### 2. å¸ƒå±€ç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å¸‚åœºæ ‡é¢˜              [Ã—]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [ Buy ]     [ Sell ]       â”‚  â† ä¹°å–åˆ‡æ¢
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚   YES    â”‚    NO    â”‚    â”‚  â† YES/NO ä»·æ ¼é€‰æ‹©
â”‚  â”‚  $0.50   â”‚  $0.50   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ•°é‡                       â”‚
â”‚  [$________]               â”‚  â† æ•°é‡è¾“å…¥
â”‚  [ $10 | $25 | $50 | $100 ]â”‚  â† å¿«é€Ÿé‡‘é¢æŒ‰é’®
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å•ä»·: $0.50               â”‚
â”‚  é¢„ä¼°ä»½é¢: 20.00            â”‚  â† é¢„ä¼°ä¿¡æ¯
â”‚  æ½œåœ¨æ”¶ç›Š: +$10.00          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    [ ä¹°å…¥ YES / å–å‡º NO ]   â”‚  â† äº¤æ˜“æŒ‰é’®
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### åœ¨ MarketCard ä¸­ä½¿ç”¨

```typescript
import CompactTradeModal from './trading/CompactTradeModal';

function YourComponent() {
  const [isModalOpen, setIsModalOpen] = useState(false);

  return (
    <>
      <button onClick={() => setIsModalOpen(true)}>
        äº¤æ˜“
      </button>

      <CompactTradeModal
        isOpen={isModalOpen}
        onClose={() => setIsModalOpen(false)}
        market={{
          id: 1,
          title: "æ¯”ç‰¹å¸æ˜¯å¦ä¼šåœ¨2025å¹´çªç ´10ä¸‡ç¾å…ƒï¼Ÿ",
          questionId: "market-1"
        }}
      />
    </>
  );
}
```

## ğŸ“Š åŠŸèƒ½ç‰¹æ€§

### 1. ä¹°å–åˆ‡æ¢
- ä¸€é”®åˆ‡æ¢ Buy/Sell æ¨¡å¼
- åŠ¨æ€é¢œè‰²æŒ‡ç¤ºï¼ˆç»¿è‰²=ä¹°å…¥ï¼Œçº¢è‰²=å–å‡ºï¼‰
- å¹³æ»‘çš„è¿‡æ¸¡åŠ¨ç”»

### 2. YES/NO é€‰æ‹©
- å¤§æŒ‰é’®è®¾è®¡ï¼Œæ˜“äºç‚¹å‡»
- å®æ—¶ä»·æ ¼æ˜¾ç¤ºï¼ˆä»è®¢å•ç°¿è·å–ï¼‰
- é€‰ä¸­çŠ¶æ€é«˜äº®æ˜¾ç¤º
- æ¸å˜èƒŒæ™¯ + é˜´å½±æ•ˆæœ

### 3. æ•°é‡è¾“å…¥
- æ”¯æŒæ‰‹åŠ¨è¾“å…¥
- å¿«é€Ÿé‡‘é¢æŒ‰é’®ï¼ˆ$10, $25, $50, $100ï¼‰
- ç¾å…ƒç¬¦å·å‰ç¼€
- èšç„¦æ—¶çš„é«˜äº®æ•ˆæœ

### 4. å®æ—¶é¢„ä¼°
- å•ä»·æ˜¾ç¤º
- é¢„ä¼°è·å¾—çš„ä»½é¢
- æ½œåœ¨æ”¶ç›Šè®¡ç®—ï¼ˆå¸¦é¢œè‰²æŒ‡ç¤ºï¼‰

### 5. æ™ºèƒ½äº¤æ˜“æŒ‰é’®
- æ ¹æ®ä¹°å–æ–¹å‘æ”¹å˜é¢œè‰²
- æ˜¾ç¤ºå½“å‰æ“ä½œï¼ˆä¹°å…¥ YES / å–å‡º NOï¼‰
- æäº¤æ—¶æ˜¾ç¤ºåŠ è½½åŠ¨ç”»
- ç¦ç”¨çŠ¶æ€å¤„ç†

## ğŸ¯ äº¤äº’æµç¨‹

1. **ç”¨æˆ·ç‚¹å‡»å¸‚åœºå¡ç‰‡çš„"äº¤æ˜“"æŒ‰é’®**
   - å¼¹çª—ä»¥åŠ¨ç”»å½¢å¼æ‰“å¼€
   - è‡ªåŠ¨è·å–æœ€æ–°ä»·æ ¼

2. **é€‰æ‹©ä¹°å–æ–¹å‘**
   - ç‚¹å‡» Buy æˆ– Sell æŒ‰é’®
   - æŒ‰é’®é«˜äº®æ˜¾ç¤ºå½“å‰é€‰æ‹©

3. **é€‰æ‹© YES æˆ– NO**
   - ç‚¹å‡»å¯¹åº”çš„ä»·æ ¼å¡ç‰‡
   - æ˜¾ç¤ºå®æ—¶ä»·æ ¼
   - é€‰ä¸­çŠ¶æ€å¸¦å¯¹å‹¾å›¾æ ‡

4. **è¾“å…¥æ•°é‡**
   - æ‰‹åŠ¨è¾“å…¥æˆ–ä½¿ç”¨å¿«é€ŸæŒ‰é’®
   - è‡ªåŠ¨è®¡ç®—é¢„ä¼°ä¿¡æ¯

5. **ç¡®è®¤äº¤æ˜“**
   - ç‚¹å‡»åº•éƒ¨äº¤æ˜“æŒ‰é’®
   - è¿æ¥é’±åŒ…ï¼ˆå¦‚æœªè¿æ¥ï¼‰
   - ç­¾åå¹¶æäº¤è®¢å•
   - æ˜¾ç¤ºæˆåŠŸæç¤º

## ğŸ”§ æŠ€æœ¯å®ç°

### ä»·æ ¼è·å–
```typescript
// ä»è®¢å•ç°¿ API è·å–å®æ—¶ä»·æ ¼
const response = await fetch(
  `/api/orders/book?marketId=${market.id}&outcome=${outcome}`,
  { signal: AbortSignal.timeout(3000) }
);
```

### è®¢å•åˆ›å»º
```typescript
// ä½¿ç”¨æ ‡å‡† Order æ¥å£
const orderData: Order = {
  orderId: generateOrderId(),
  marketId: market.id,
  maker: userAddress,
  side: side, // 'buy' or 'sell'
  outcome: outcomeValue, // 0 = NO, 1 = YES
  price: currentPrice.toString(),
  amount: amount,
  salt: generateSalt(),
  nonce: Date.now(),
  expiration: Math.floor(Date.now() / 1000) + 86400
};
```

### ç­¾åå’Œæäº¤
```typescript
// EIP-712 ç­¾å
const signature = await signOrder(orderData, signer);

// æäº¤åˆ° API
await fetch('/api/orders/create', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({ ...orderData, signature })
});
```

## ğŸ¨ æ ·å¼è®¾è®¡

### é¢œè‰²æ–¹æ¡ˆ
- **Buy (ä¹°å…¥)**: ç»¿è‰²ç³» (`emerald-500` ~ `emerald-700`)
- **Sell (å–å‡º)**: çº¢è‰²ç³» (`rose-500` ~ `rose-700`)
- **YES**: ç»¿è‰²æ¸å˜ + é˜´å½±æ•ˆæœ
- **NO**: çº¢è‰²æ¸å˜ + é˜´å½±æ•ˆæœ
- **èƒŒæ™¯**: æ·±è‰²åŠé€æ˜ (`zinc-900/95` + `backdrop-blur-md`)
- **è¾¹æ¡†**: ç™½è‰²åŠé€æ˜ (`white/10`)

### åŠ¨ç”»æ•ˆæœ
- **å¼¹çª—æ‰“å¼€**: `fade-in` + `zoom-in-95`
- **æŒ‰é’®æ‚¬åœ**: `scale-[1.02]` + `shadow-lg`
- **åŠ è½½çŠ¶æ€**: `animate-spin` (loading spinner)
- **ä»·æ ¼åŠ è½½**: `animate-pulse`

## ğŸ“± å“åº”å¼è®¾è®¡

- ç§»åŠ¨ç«¯ï¼šå¡ç‰‡å®½åº¦è‡ªé€‚åº”ï¼ˆ`w-full max-w-sm`ï¼‰
- å¹³æ¿/æ¡Œé¢ï¼šå›ºå®šæœ€å¤§å®½åº¦ï¼ˆ`max-w-sm = 384px`ï¼‰
- è§¦æ‘¸å‹å¥½ï¼šæŒ‰é’®å¤§å°é€‚ä¸­ï¼Œé—´è·åˆç†
- å‚ç›´æ»šåŠ¨ï¼šå†…å®¹è¾ƒå¤šæ—¶å¯æ»šåŠ¨

## ğŸŒ å›½é™…åŒ–æ”¯æŒ

ä½¿ç”¨ `useTranslation` hookï¼š
- è‹±æ–‡ï¼šBuy / Sell / Trade
- ä¸­æ–‡ï¼šä¹°å…¥ / å–å‡º / äº¤æ˜“
- æ”¯æŒåŠ¨æ€åˆ‡æ¢

## ğŸ”„ ä¸åŸæœ‰å¼¹çª—çš„åŒºåˆ«

### QuickTradeModal (æ—§ç‰ˆ)
- å›ºå®šä¾§å‘ï¼ˆYES æˆ– NOï¼‰
- å›ºå®šä¹°å…¥æ¨¡å¼
- è¾ƒå¤§çš„å°ºå¯¸
- æ›´å¤šä¿¡æ¯å±•ç¤º

### CompactTradeModal (æ–°ç‰ˆ)
- âœ… å¯é€‰æ‹© Buy/Sell
- âœ… å¯é€‰æ‹© YES/NO
- âœ… æ›´ç´§å‡‘çš„è®¾è®¡
- âœ… æ›´æ¸…æ™°çš„å¸ƒå±€
- âœ… æ›´æµç•…çš„äº¤äº’

## ğŸ“¦ ç»„ä»¶ä¾èµ–

```typescript
// å¿…éœ€ä¾èµ–
import { createPortal } from 'react-dom';
import { ethers } from 'ethers';
import { signOrder, generateSalt, generateOrderId } from '@/lib/clob/signing';
import { useTranslation } from '@/hooks/useTranslation';
import { useToast } from '@/components/Toast';
```

## ğŸ› é”™è¯¯å¤„ç†

1. **é’±åŒ…æœªå®‰è£…**: æç¤ºå®‰è£… MetaMask
2. **ç”¨æˆ·å–æ¶ˆç­¾å**: å‹å¥½çš„å–æ¶ˆæç¤º
3. **ç½‘ç»œé”™è¯¯**: æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
4. **ä»·æ ¼è·å–è¶…æ—¶**: ä½¿ç”¨é»˜è®¤ä»·æ ¼ (0.50)
5. **è®¢å•æäº¤å¤±è´¥**: Toast é”™è¯¯æç¤º

## ğŸ¯ æœ€ä½³å®è·µ

1. **é¢„åŠ è½½ä»·æ ¼**: å¼¹çª—æ‰“å¼€æ—¶ç«‹å³è·å–ä»·æ ¼
2. **è¶…æ—¶å¤„ç†**: ä»·æ ¼è¯·æ±‚è®¾ç½® 3 ç§’è¶…æ—¶
3. **åŠ è½½çŠ¶æ€**: ä½¿ç”¨ skeleton æˆ– pulse åŠ¨ç”»
4. **é˜²é‡å¤æäº¤**: æäº¤ä¸­ç¦ç”¨æŒ‰é’®
5. **å…³é—­ååˆ·æ–°**: æˆåŠŸäº¤æ˜“ååˆ·æ–°é¡µé¢æ•°æ®

## ğŸ“ å¾…ä¼˜åŒ–

- [ ] æ·»åŠ æ»‘ç‚¹è®¾ç½®
- [ ] æ”¯æŒé™ä»·å•
- [ ] æ·»åŠ å†å²è®°å½•
- [ ] æ”¯æŒæ‰¹é‡äº¤æ˜“
- [ ] æ·»åŠ ä»·æ ¼å›¾è¡¨
- [ ] ä¼˜åŒ–ç§»åŠ¨ç«¯ä½“éªŒ
- [ ] æ·»åŠ é”®ç›˜å¿«æ·é”®

## ğŸ”— ç›¸å…³æ–‡ä»¶

- ç»„ä»¶: `components/trading/CompactTradeModal.tsx`
- å¸‚åœºå¡ç‰‡: `components/MarketCard.tsx`
- ç­¾ååº“: `lib/clob/signing.ts`
- API: `/api/orders/create`
- ç¿»è¯‘: `locales/zh.json`, `locales/en.json`

